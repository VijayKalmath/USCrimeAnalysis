# Missing values

## JAR Gender 


a)
```{R}
library(tidyverse)
library(patchwork)
library(ggplot2)
library(naniar)

source("plot_missing.R")

df <- read.csv("data/Juvenile_Gender_Records.csv")

plot_missing(df,percent = FALSE)


```

b)

```{R}
gg_miss_upset(df)
gg_miss_var(df, show_pct = TRUE)
```



```{r}

df %>% head()
```


```{r}

df  %>%
  summarise_all(list(~is.na(.)))
```


```{r}
df  %>%
  summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) 

```

c) Stacked Bar plot to represent the number of missing data in each column

```{r}

df  %>%
 summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col()+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```
d) Stacked Bar plot to represent proportion of missing data in each column


```{r}
df  %>%
  summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col(position = "fill")+
  labs(x="Proportion")+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```


## JAR Race 

a)


```{R}
source("plot_missing.R")

df <- read.csv("data/Juvenile_Race_Records.csv")

plot_missing(df,percent = FALSE)


```

```{R}
gg_miss_upset(df)
gg_miss_var(df, show_pct = TRUE)
```



```{r}

df %>% head()
```



c) Stacked Bar plot to represent the number of missing data in each column

```{r}

df  %>%
 summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col()+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```
d) Stacked Bar plot to represent proportion of missing data in each column


```{r}
df  %>%
  summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col(position = "fill")+
  labs(x="Proportion")+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```


## Hate Crime Data 

```{R}

df <- read.csv("data/hate_crime.csv")

plot_missing(df,percent = FALSE)


```
```{R}
gg_miss_fct(x = df, fct = STATE_NAME) + labs(title = "NA")
```

```{R}
gg_miss_fct(x = df, fct = VICTIM_TYPES) + labs(title = "NA")
```



```{R}
gg_miss_upset(df)
```

c) Stacked Bar plot to represent the number of missing data in each column

```{r}

df  %>%
 summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col()+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```


d) Stacked Bar plot to represent proportion of missing data in each column


```{r}
df  %>%
  summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col(position = "fill")+
  labs(x="Proportion")+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```