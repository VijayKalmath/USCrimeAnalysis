# Missing Values

```{r}
# Import All Necessary Libraries
library(tidyverse)
library(patchwork)
library(repr)
library(ggnewscale)
library(RColorBrewer)
library(Lock5withR)
library(naniar)
library(ggplot2)

# Import Helper Libraries
source("R_Scripts/plot_missing.R")
source("R_Scripts/readJar.R")
source("R_Scripts/readGVA.R")
```

In this chapter , we take a deep look into the data that we have and analyze missing data patterns, furthermore we try to explain the reasoning behind the missing data.  

## Missing Data in Juvenile Arrest Records 

```{r,fig.align='center',fig.height=8,fig.width=8}
# Read Csv Files

JuvenileList = readJar()

JuvelineArrestdf = data.frame(JuvenileList[1])
JuvelineArrestGenderdf = data.frame(JuvenileList[2])
JuvelineArrestRacedf = data.frame(JuvenileList[3])
```


```{r,fig.align='center',fig.height=8,fig.width=8}
gg_miss_upset(JuvelineArrestdf,nsets = 10)

```
 
An Upset plot can be used to visualize the number of times certain variables are missing together with the other variables. This gives the combinations of variables which are missing. The vertical bar shows the intersection values of missing elements in the set. The horizontal bars show the set size of missing values in each variable. 
In this particular graph, the variables are years. The only variables which have missing values are years from 2010 through 2019. From the size of the set we can see that years 2013 - 2019 have equal number of missing values. 2010-2012 however, have fewer missing value. Hence we can see that there are two sets of overlaps. The height of the vertical bar shows the amount of missing data. We can see that there are 2 categories of crime which have missing data from 2013-2019 (left bar), and two categories of crime which have missing data from 2010-2019.

```{r,fig.align='center',fig.height=8,fig.width=8}
gg_miss_var(JuvelineArrestdf, show_pct = TRUE)
```
We can also look at the what percentage of values are missing from every variable. Unlike overlap, this gives us the absolute estimate of how much data we have missed. We can see that years 2013 to 2019 have the same amount of data missing as we concluded from the previous plot. Here we can see that it is little over 9% missing values of data per variable. Similarly, years 2010-2012 the percentage missing is even less. 

We plot the upset plot and the percentage missing values plot for the Juvenile Race records as well. We can see a similar trend in missing values in this. We can thus conclude that there is a gap in our data for 4 types of crimes and it is consistent throughout all classifications.

```{r,fig.align='center',fig.height=8,fig.width=8}

JuvenileArrestMissingPlot <- plot_missing(JuvelineArrestdf,percent = TRUE)
JuvenileArrestMissingPlot
```


## Missing Data in Gun Violence Archive

```{r,fig.align='center',fig.height=8,fig.width=8}
# Read Csv Files

GVAList = readGVA()

GVAMassShootingdf = data.frame(GVAList[1])
GVAAccidentalInjuriesdf = data.frame(GVAList[2])
GVAAccidentalDeathsdf = data.frame(GVAList[3])
```

d) Stacked Bar plot to represent proportion of missing data in each column

```{r}
GVAMassShootingdf  %>%
  summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col(position = "fill")+
  labs(x="Proportion")+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())

```

```{r}
GVAMassShootingPlot <- plot_missing(GVAMassShootingdf,percent = TRUE)
GVAMassShootingPlot
```


## Missing Data in Hate Crime Data 

