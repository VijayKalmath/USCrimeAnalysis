# Missing values

## JAR Gender 


a)
```{R}
library(tidyverse)
library(patchwork)
library(ggplot2)
library(naniar)

source("plot_missing.R")

df <- read.csv("data/Juvenile_Gender_Records.csv")

plot_missing(df,percent = FALSE)


```

b)

```{R}
gg_miss_upset(df,nsets = n_var_miss(df))

```
 
An Upset plot can be used to visualize the number of times certain variables are missing together with the other variables. This gives the combinations of variables which are missing. The vertical bar shows the intersection values of missing elements in the set. The horizontal bars show the set size of missing values in each variable. 
In this particular graph, the variables are years. The only variables which have missing values are years from 2010 through 2019. From the size of the set we can see that years 2013 - 2019 have equal number of missing values. 2010-2012 however, have fewer missing value. Hence we can see that there are two sets of overlaps. The height of the vertical bar shows the amount of missing data. We can see that there are 2 categories of crime which have missing data from 2013-2019 (left bar), and two categories of crime which have missing data from 2010-2019.

```{R}
gg_miss_var(df, show_pct = TRUE)
```
We can also look at the what percentage of values are missing from every variable. Unlike overlap, this gives us the absolute estimate of how much data we have missed. We can see that years 2013 to 2019 have the same amount of data missing as we concluded from the previous plot. Here we can see that it is little over 9% missing values of data per variable. Similarly, years 2010-2012 the percentage missing is even less. 

```{r}

df %>% head()
```


```{r}

df  %>%
  summarise_all(list(~is.na(.)))
```


```{r}
df  %>%
  summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) 

```

c) Stacked Bar plot to represent the number of missing data in each column

```{r}

df  %>%
 summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col()+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```
d) Stacked Bar plot to represent proportion of missing data in each column


```{r}
df  %>%
  summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col(position = "fill")+
  labs(x="Proportion")+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```


## JAR Race 

a)


```{R}
source("plot_missing.R")

df2 <- read.csv("data/Juvenile_Race_Records.csv")

plot_missing(df2,percent = FALSE)


```

```{R}
gg_miss_upset(df2, nsets = n_var_miss(df2))
```



```{R}
gg_miss_var(df2, show_pct = TRUE)
```

We plot the upset plot and the percentage missing values plot for the Juvenile Race records as well. We can see a similar trend in missing values in this. We can thus conclude that there is a gap in our data for 4 types of crimes and it is consistent throughout all classifications.

```{r}

df2 %>% head()
```



c) Stacked Bar plot to represent the number of missing data in each column

```{r}

df2  %>%
 summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col()+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```
d) Stacked Bar plot to represent proportion of missing data in each column


```{r}
df2  %>%
  summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col(position = "fill")+
  labs(x="Proportion")+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```


## Hate Crime Data 

```{R}

df3 <- read.csv("data/hate_crime.csv")

plot_missing(df3,percent = FALSE)


```

To analyze the missing data in Hate Crime, we will be using Heat map visualization. We will consider it based o two variables: State and Year. To do this we create a slightly different heat map. The plot shows the number of missing values in each column, but they are broken down by one of the variables. 

```{R}
gg_miss_fct(x = df3, fct = STATE_NAME) + labs(title = "Missing Values Heat Map")
```
We can now see how many values are missing in each variable, and the proportion throughout the states. We can see that majority of the data is missing in juvenile and adult victim and offender count variables, with some missing data in individual victims.We can also analyze which states have more missing data by looking at the percentage missing data in its column. e.g Guam has a high amount of missing data.

```{R}
gg_miss_fct(x = df3, fct = DATA_YEAR) + labs(title = "Missing Values Heat Map")
```

Additionally we can also look at the year of data collection. Again we see data is missing from the variables mentioned earlier. But now we can also observe that the major chunk missing from 1990-2010. Thus we can say that these variables have been recorded and documented quite recently.

```{R}
gg_miss_upset(df3)
```
The upset plot for Hate crime shows much more overlaps. The biggest overlap as we can see is the missing data in victim and offender counts. But there is also some overlap with total individual victims. The intersection are then a sort of permuations of these variables where only few of them were missing. 

c) Stacked Bar plot to represent the number of missing data in each column

```{r}

df3  %>%
 summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col()+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```


d) Stacked Bar plot to represent proportion of missing data in each column


```{r}
df3  %>%
  summarise_all(list(~is.na(.)))%>%
  pivot_longer(everything(),
               names_to = "variables", values_to="missing") %>%
  count(variables, missing) %>%
  ggplot(aes(y=variables,x=n,fill=missing))+
  geom_col(position = "fill")+
  labs(x="Proportion")+
  scale_fill_manual(values=c("skyblue3","gold"))+
  theme(axis.title.y=element_blank())
```